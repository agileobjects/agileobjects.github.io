(function(n){var u=n.derive(function(n){this._base.call(this,n.getByCss('input[type="submit"]'))}),i,t;u.prototype.confirm=function(){return this.e.value==="Confirm"?!0:(this.e.defaultText=this.e.value,this.e.defaultTitle=this.e.title,this.e.value="Confirm",this.e.title="Click again to confirm",this.addClass("confirm-button"),!1)};u.prototype.reset=function(){this.e.value=this.e.defaultText;this.e.title=this.e.defaultTitle;this.removeClass("confirm-button")};i=n.derive(function(){this._base.call(this,"popup")});i.prototype.show=function(t){var i=n(t);return i.getByCss(".message")&&this.addClass("with-message"),this.html(i.html()),this};i.prototype.reset=function(){return this.removeClass("with-message")};var f={required:function(){return Boolean(this.e.value)},email:function(){return n.isEmail(this.e.value)},recaptcha:function(){return this.e.value=grecaptcha.getResponse(),Boolean(this.e.value)}},e=Object.keys(f),o=e.length,r=n.derive(function(t){var i,r,u;this._base.call(this,t);this.on("blur keyup",this.validate);for(this._msg=n(this.e.nextElementSibling),this._msg.hasClass("error-message")===!1&&(this._msg=n("<span>").addClass("error-message"),this.after(this._msg)),this._validators=[],i=0;i<o;++i)r=e[i],u=this.attr("data-val-"+r),Boolean(u)&&this._validators.push({test:f[r],msg:u})});r.prototype.setValid=function(n){var t,i;return n?(t="error",i="valid"):(t="valid",i="error"),this._msg.removeClass("field-validation-"+t).addClass("field-validation-"+i),this};r.prototype.validate=function(){for(var t,n=0,i=this._validators.length;n<i;++n)if(t=this._validators[n],t.test.call(this)===!1)return this._msg.html(t.msg),this.setValid(!1),!1;return this.setValid(!0),!0};t=n.derive(function(t){var f,o,e;for(this._base.call(this,t),this._cover=n("progress-cover"),this._popup=new i,this.submit=new u(this),this._validators=[],f=0,o=t.length;f<o;++f)(e=t[f],Boolean(e.getAttribute("data-val")))&&this._validators.push(new r(e))});t.prototype.validate=function(){for(var t=!0,n=0,i=this._validators.length;n<i;++n)this._validators[n].validate()===!1&&(t=!1);return t};t.prototype.submitting=function(){return this._cover.removeClass("hidden"),this.disable(),this._popup.show("progress").hide().removeClass("hidden").fadeIn(),this};t.prototype.ok=function(){return this._popup.show("complete-ok"),this};t.prototype.error=function(){return this._popup.show("complete-error"),this};t.prototype.reset=function(){return this._popup.fadeOut(function(){this.reset()}),this.submit.reset(),this.enable(),this._cover.addClass("hidden"),this};n.form=function(n){return typeof n=="undefined"&&(n=document.forms[0]),new t(n)};n.validator=function(n){return new r(n)};n(function(){for(var f,r=n.getAllByCss(".has-tooltip"),t=0,e=r.length;t<e;++t){var i=n(r[t]),o=i.attr("data-tooltip"),u=n("<span>").addClass("tooltip").html(o);(i.removeAttr("data-tooltip").append(u),f=i.attr("data-tooltip-pos"),Boolean(f))&&u.css("left","auto","right",0,"bottom","29px")}})})(Ao);